from contractvmd.chain.message import Message

from forvmproto.ForvmProto

class NewPost(Message):
    def post (key, title, text):
        m = CreateNewPostMessage ()
        m.Key = key
        m.Title = title
        m.Text = text
        m.DappCode = ForvmProto.DAPP_CODE
        m.Method = ForvmProto.METHOD_REG
        return m

    def toJSON (self):
        data = super (CreateNewPostMessage, self).toJSON ()

        if self.Method == ForvmProto.METHOD_REG:
            data['key'] = self.Key
            data['title'] = self.Title
            data['text'] = self.Text
        else:
            return None

        return data
